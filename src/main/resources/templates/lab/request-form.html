<!DOCTYPE html>
<html lang="tr" xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="content">
    <div class="card">
        <div class="card-header">
            <div class="card-title">Yeni Lab İsteği</div>
        </div>

        <form th:action="@{/lab/requests}" method="post" class="form-grid">
            <div class="form-group" style="grid-column:1 / span 2;">
                <label class="form-label">Muayene</label>
                <select class="form-select" name="examinationId" required>
                    <option value="">Seçiniz</option>
                    <option th:each="e : ${examinations}"
                            th:value="${e.id}"
                            th:text="${'Muayene #' + e.id + ' - ' + (e.patient != null ? e.patient.firstName + ' ' + e.patient.lastName : '')}">
                    </option>
                </select>
            </div>

            <div class="form-group" style="grid-column:1 / span 2;">
                <label class="form-label">İstenilen Testler</label>

                <div style="display:flex;flex-direction:column;gap:4px;max-height:260px;overflow-y:auto;
                padding:6px;border-radius:10px;border:1px solid rgba(148,163,184,0.4);">
                    <label th:each="t : ${tests}" style="display:flex;align-items:center;gap:8px;font-size:13px;">
                        <input type="checkbox" name="testIds" th:value="${t.id}">
                        <span>
                <span th:text="${t.name}">Test Adı</span>
                <span th:if="${t.code != null}" style="opacity:0.7;">
                    [<span th:text="${t.code}">KOD</span>]
                </span>
            </span>
                    </label>
                </div>

                <small style="font-size:11px;opacity:0.7;">
                    Birden fazla test seçmek için kutucukları işaretleyin.
                </small>
            </div>


            <div style="grid-column:1 / span 2;display:flex;justify-content:flex-end;gap:8px;margin-top:6px;">
                <a th:href="@{/lab/requests}" class="btn btn-ghost">İptal</a>
                <button type="submit" class="btn btn-primary">Kaydet</button>
            </div>
        </form>
    </div>
</div>
</body>
</html>
